Zilog Z8 Encore! Macro Assembler Version 2.52 (11010702) 20-Oct-16     22:34:09     page:   1


PC     Object              I  Line    Source 
                           A     1    ; Zilog Z8 Encore! ANSI C Compiler Release 3.62
                           A     2    ; -nolocalcse -optsize -fastcall -const=RAM -mo
                           A     3    ; -nooptlink -regvar -reduceopt -debug -norevaa
                           A     4    ; -alias 
                           A     5    	DEFINE uart_TEXT,SPACE=ROM
                           A     6    	FILE	"..\..\..\..\DOCUME~1\GITHUB\THIRDY
                           A     7    .debug "C"
                           A     8    	SEGMENT FAR_DATA
000000                     A     9    _inChar:
000000 00                  A    10    	DB	0
                           A    11    .define "inChar"
                           A    12    .alias "_inChar"
                           A    13    .class 69
                           A    14    .value _inChar
                           A    15    .type 2
                           A    16    .type 0
                           A    17    .endef
                           A    18    	SEGMENT FAR_BSS
000000                     A    19    _string:
000000                     A    20    	DS	25
                           A    21    .define "string"
                           A    22    .alias "_string"
                           A    23    .class 83
                           A    24    .value _string
                           A    25    .dim 25
                           A    26    .type 98
                           A    27    .type 0
                           A    28    .endef
                           A    29    	SEGMENT FAR_DATA
000001                     A    30    _txFinished:
000001 01                  A    31    	DB	1
                           A    32    .define "txFinished"
                           A    33    .alias "_txFinished"
                           A    34    .class 69
                           A    35    .value _txFinished
                           A    36    .type 2
                           A    37    .type 0
                           A    38    .endef
000002                     A    39    _command:
000002 00                  A    40    	DB	0
                           A    41    .define "command"
                           A    42    .alias "_command"
                           A    43    .class 69
                           A    44    .value _command
                           A    45    .type 2
                           A    46    .type 0
                           A    47    .endef
000003                     A    48    _rxFlag:
000003 00                  A    49    	DB	0
                           A    50    .define "rxFlag"
                           A    51    .alias "_rxFlag"
                           A    52    .class 69
Zilog Z8 Encore! Macro Assembler Version 2.52 (11010702) 20-Oct-16     22:34:09     page:   2


PC     Object              I  Line    Source uart.src
                           A    53    .value _rxFlag
                           A    54    .type 2
                           A    55    .type 0
                           A    56    .endef
                           A    57    	SEGMENT ROM_DATA
                           A    58    
                           A    59    
                           A    60    ;**************************** _init_coms ******
                           A    61    ;Name                         Addr/Register   S
                           A    62    ;_isr_U1_TX                          IMPORT  --
                           A    63    ;_isr_U1_RX                          IMPORT  --
                           A    64    ;_SET_VECTOR                         IMPORT  --
                           A    65    
                           A    66    
                           A    67    ; Aggregate Stack Size: 0 (words)
                           A    68    
                           A    69    
                           A    70    	.FRAME _n_init_coms,?_n_init_coms,RDATA
                           A    71    	.FRAME _f_init_coms,?_f_init_coms,EDATA
                           A    72    	SEGMENT uart_TEXT
000000                     A    73    _init_coms:
                           A    74    .define "_init_coms"
                           A    75    .value _init_coms
                           A    76    .class 2
                           A    77    .type 65
                           A    78    .type 0
                           A    79    .endef
                           A    80    .begfunc "init_coms",4,"_init_coms"
000000 D6 0000             A    81    	CALL	__b_frameset00
                           A    82    ;    1	#include <uart.h>
                           A    83    ;    2	// char rxFlag = 0;
                           A    84    ;    3	
                           A    85    ;    4	void init_coms(void){
                           A    86    ;    5		U0BRH = 0x00;
                           A    87    .line 5
000003 E9000F46            A    88    	LDX	3910,#-0
                           A    89    ;    6		U0BRL = 0x82;
                           A    90    .line 6
000007 E9820F47            A    91    	LDX	3911,#130
                           A    92    ;    7	
                           A    93    ;    8	  //CHANGE PA4&5 are BT RX< TX
                           A    94    ;    9		PAAF |= 0x30;
                           A    95    .line 9
00000B E9020FD0            A    96    	LDX	4048,#2
00000F 49300FD1            A    97    	ORX	4049,#48
                           A    98    ;   10		PADD &= ~0x20;
                           A    99    .line 10
000013 E9010FD0            A   100    	LDX	4048,#1
000017 59DF0FD1            A   101    	ANDX	4049,#-33
                           A   102    ;   11		PADD |= 0x10;
                           A   103    .line 11
00001B E9010FD0            A   104    	LDX	4048,#1
Zilog Z8 Encore! Macro Assembler Version 2.52 (11010702) 20-Oct-16     22:34:09     page:   3


PC     Object              I  Line    Source uart.src
00001F 49100FD1            A   105    	ORX	4049,#16
                           A   106    ;   12		PAADDR = 0x00;
                           A   107    .line 12
000023 E9000FD0            A   108    	LDX	4048,#-0
                           A   109    ;   13	
                           A   110    ;   14		SET_VECTOR(UART0_RX, isr_U1_RX);
                           A   111    ;   15		SET_VECTOR(UART0_TX, isr_U1_TX);
                           A   112    ;   16	
                           A   113    ;   17		IRQ0 |= 0x04;
                           A   114    .line 17
000027 49040FC0            A   115    	ORX	4032,#4
                           A   116    ;   18		IRQ0ENH &= ~0x18;
                           A   117    .line 18
00002B 59E70FC1            A   118    	ANDX	4033,#-25
                           A   119    ;   19		IRQ0ENL |= 0x18;
                           A   120    .line 19
00002F 49180FC2            A   121    	ORX	4034,#24
                           A   122    ;   20	
                           A   123    ;   21	
                           A   124    ;   22		U0CTL0 = 0xC0;
                           A   125    .line 22
000033 E9C00F42            A   126    	LDX	3906,#192
                           A   127    ;   23		U0CTL1 = 0x00;
                           A   128    .line 23
000037 E9000F43            A   129    	LDX	3907,#-0
                           A   130    ;   24	
                           A   131    ;   25		
                           A   132    ;   26	}
                           A   133    .line 26
00003B D6 0000             A   134    	CALL	__b_framereset
00003E AF                  A   135    	RET	
                           A   136    .endfunc "init_coms",26,"_init_coms"
                           A   137    	SEGMENT ROM_DATA
                           A   138    
                           A   139    
                           A   140    ;**************************** _sendString *****
                           A   141    ;Name                         Addr/Register   S
                           A   142    ;_strlen                             IMPORT  --
                           A   143    ;_txFinished                         STATIC    
                           A   144    ;size                                    R0    
                           A   145    ;current                                 R2    
                           A   146    ;stringSend                           R15-2    
                           A   147    
                           A   148    
                           A   149    ; Aggregate Stack Size: -3 (words)
                           A   150    
                           A   151    
                           A   152    	.FRAME _n_sendString,?_n_sendString,RDATA
                           A   153    	.FCALL _n_strlen
                           A   154    	.FRAME _f_sendString,?_f_sendString,EDATA
                           A   155    	.FCALL _f_strlen
                           A   156    	SEGMENT uart_TEXT
Zilog Z8 Encore! Macro Assembler Version 2.52 (11010702) 20-Oct-16     22:34:09     page:   4


PC     Object              I  Line    Source uart.src
00003F                     A   157    _sendString:
                           A   158    .define "_sendString"
                           A   159    .value _sendString
                           A   160    .class 2
                           A   161    .type 65
                           A   162    .type 0
                           A   163    .endef
                           A   164    .begfunc "sendString",28,"_sendString"
                           A   165    .define "stringSend"
                           A   166    .class 9
                           A   167    .value -2
                           A   168    .type 162
                           A   169    .type 0
                           A   170    .endef
00003F 5C03                A   171    	LD	R5,#3
000041 D6 0000             A   172    	CALL	__b_frameset0
000044 89E8FE              A   173    	LDX	-2(RR14),R8
000047 89E9FF              A   174    	LDX	-1(RR14),R9
                           A   175    ;   27	
                           A   176    ;   28	void sendString(char stringSend[25]){
                           A   177    .define "U‹ìjÿh0/J"
                           A   178    .class 4
                           A   179    .reg 3
                           A   180    .type 2
                           A   181    .type 0
                           A   182    .endef
                           A   183    .define "U‹ìjÿh0/J"
                           A   184    .class 4
                           A   185    .reg 1
                           A   186    .type 2
                           A   187    .type 0
                           A   188    .endef
                           A   189    ;   29		char current = 0;
                           A   190    .line 29
00004A B0E2                A   191    	CLR	R2
                           A   192    ;   30		char size = 0;
                           A   193    .line 30
                           A   194    ;   31		txFinished = 1;
                           A   195    .line 31
00004C E9010001            A   196    	LDX	_txFinished,#1
                           A   197    ;   32		size = strlen(stringSend);
                           A   198    .line 32
000050 888EFE              A   199    	LDX	R8,-2(RR14)
000053 889EFF              A   200    	LDX	R9,-1(RR14)
000056 89E2FD              A   201    	LDX	-3(RR14),R2
000059 D6 0000             A   202    	CALL	_strlen
00005C 882EFD              A   203    	LDX	R2,-3(RR14)
00005F E4E1E0              A   204    	LD	R0,R1
                           A   205    ;   33		while(1){
000062                     A   206    _2_L_5:
                           A   207    .line 33
                           A   208    ;   34			if(txFinished==1)
Zilog Z8 Encore! Macro Assembler Version 2.52 (11010702) 20-Oct-16     22:34:09     page:   5


PC     Object              I  Line    Source uart.src
                           A   209    .line 34
000062 A9010001            A   210    	CPX	_txFinished,#1
000066 EB FA               A   211    	JR	NE,_2_L_5
                           A   212    ;   35				{
                           A   213    ;   36				if(current < size){
                           A   214    .line 36
000068 A220                A   215    	CP	R2,R0
00006A 9B 1E               A   216    	JR	GE,_2_L_3
                           A   217    ;   37					U0TXD = stringSend[curr
                           A   218    .line 37
00006C E4E2E1              A   219    	LD	R1,R2
00006F 90E1                A   220    	RL	R1
000071 3211                A   221    	SBC	R1,R1
000073 884EFE              A   222    	LDX	R4,-2(RR14)
000076 885EFF              A   223    	LDX	R5,-1(RR14)
000079 0252                A   224    	ADD	R5,R2
00007B 1241                A   225    	ADC	R4,R1
00007D 86E4E1              A   226    	LDX	R1,@RR4
000080 941F40              A   227    	LDX	3904,R1
                           A   228    ;   38					current++;
                           A   229    .line 38
000083 2E                  A   230    	INC	R2
                           A   231    ;   39					txFinished = 0;
                           A   232    .line 39
000084 E9000001            A   233    	LDX	_txFinished,#-0
                           A   234    ;   40				} else {
                           A   235    .line 40
000088 8B D8               A   236    	JR	_2_L_5
00008A                     A   237    _2_L_3:
                           A   238    ;   41					current = 0;
                           A   239    .line 41
                           A   240    ;   42					txFinished = 0;
                           A   241    .line 42
00008A E9000001            A   242    	LDX	_txFinished,#-0
                           A   243    ;   43					break;
                           A   244    ;   44				}
                           A   245    ;   45			}
                           A   246    ;   46		}
                           A   247    ;   47	
                           A   248    ;   48	}
                           A   249    .line 48
00008E D6 0000             A   250    	CALL	__b_framereset
000091 AF                  A   251    	RET	
                           A   252    .endfunc "sendString",48,"_sendString"
                           A   253    	SEGMENT ROM_DATA
                           A   254    
                           A   255    
                           A   256    ;**************************** _commandF *******
                           A   257    ;Name                         Addr/Register   S
                           A   258    ;_command                            STATIC    
                           A   259    ;temp                                    R1    
                           A   260    
Zilog Z8 Encore! Macro Assembler Version 2.52 (11010702) 20-Oct-16     22:34:09     page:   6


PC     Object              I  Line    Source uart.src
                           A   261    
                           A   262    ; Aggregate Stack Size: 0 (words)
                           A   263    
                           A   264    
                           A   265    	.FRAME _n_commandF,?_n_commandF,RDATA
                           A   266    	.FRAME _f_commandF,?_f_commandF,EDATA
                           A   267    	SEGMENT uart_TEXT
000092                     A   268    _commandF:
                           A   269    .define "_commandF"
                           A   270    .value _commandF
                           A   271    .class 2
                           A   272    .type 66
                           A   273    .type 0
                           A   274    .endef
                           A   275    .begfunc "commandF",50,"_commandF"
                           A   276    ;   49	
                           A   277    ;   50	char commandF(void){
                           A   278    .define "U‹ìjÿh0/J"
                           A   279    .class 4
                           A   280    .reg 2
                           A   281    .type 2
                           A   282    .type 0
                           A   283    .endef
000092 D6 0000             A   284    	CALL	__b_frameset00
                           A   285    ;   51		char temp = command;
                           A   286    .line 51
000095 841002              A   287    	LDX	R1,_command
                           A   288    ;   52		command = 0;
                           A   289    .line 52
000098 E9000002            A   290    	LDX	_command,#-0
                           A   291    ;   53		return temp;
                           A   292    .line 53
00009C E4E1E0              A   293    	LD	R0,R1
                           A   294    ;   54	}
                           A   295    .line 54
00009F D6 0000             A   296    	CALL	__b_framereset
0000A2 AF                  A   297    	RET	
                           A   298    .endfunc "commandF",54,"_commandF"
                           A   299    	SEGMENT ROM_DATA
                           A   300    
                           A   301    
                           A   302    ;**************************** _isr_U1_RX ******
                           A   303    ;Name                         Addr/Register   S
                           A   304    ;_EI                                 IMPORT  --
                           A   305    ;_command                            STATIC    
                           A   306    ;_DI                                 IMPORT  --
                           A   307    
                           A   308    
                           A   309    ; Aggregate Stack Size: 0 (words)
                           A   310    
                           A   311    
                           A   312    	.FRAME _n_isr_U1_RX,?_n_isr_U1_RX,RDATA
Zilog Z8 Encore! Macro Assembler Version 2.52 (11010702) 20-Oct-16     22:34:09     page:   7


PC     Object              I  Line    Source uart.src
                           A   313    	.FRAME _f_isr_U1_RX,?_f_isr_U1_RX,EDATA
                           A   314    	SEGMENT uart_TEXT
0000A3                     A   315    _isr_U1_RX:
                           A   316    .define "_isr_U1_RX"
                           A   317    .value _isr_U1_RX
                           A   318    .class 2
                           A   319    .type 65
                           A   320    .type 0
                           A   321    .endef
                           A   322    .begfunc "isr_U1_RX",57,"_isr_U1_RX"
0000A3 C8FFD0              A   323    	PUSHX	4093
0000A6 D6 0000             A   324    	CALL	__b_iframeset00
                           A   325    ;   55	
                           A   326    ;   56	#pragma interrupt
                           A   327    ;   57	void isr_U1_RX(void){
                           A   328    ;   58		DI();
                           A   329    .line 58
0000A9 8F                  A   330    	DI
                           A   331    ;   59		command = U0RXD;
                           A   332    .line 59
0000AA E8F40002            A   333    	LDX	_command,3904
                           A   334    ;   60		IRQ0 &= ~0x40;
                           A   335    .line 60
0000AE 59BF0FC0            A   336    	ANDX	4032,#-65
                           A   337    ;   61		EI();
                           A   338    .line 61
0000B2 9F                  A   339    	EI
                           A   340    ;   62	}
                           A   341    .line 62
0000B3 D6 0000             A   342    	CALL	__b_iframereset
0000B6 BF                  A   343    	IRET	
                           A   344    .endfunc "isr_U1_RX",62,"_isr_U1_RX"
                           A   345    	SEGMENT ROM_DATA
                           A   346    
                           A   347    
                           A   348    ;**************************** _isr_U1_TX ******
                           A   349    ;Name                         Addr/Register   S
                           A   350    ;_txFinished                         STATIC    
                           A   351    
                           A   352    
                           A   353    ; Aggregate Stack Size: 0 (words)
                           A   354    
                           A   355    
                           A   356    	.FRAME _n_isr_U1_TX,?_n_isr_U1_TX,RDATA
                           A   357    	.FRAME _f_isr_U1_TX,?_f_isr_U1_TX,EDATA
                           A   358    	SEGMENT uart_TEXT
0000B7                     A   359    _isr_U1_TX:
                           A   360    .define "_isr_U1_TX"
                           A   361    .value _isr_U1_TX
                           A   362    .class 2
                           A   363    .type 65
                           A   364    .type 0
Zilog Z8 Encore! Macro Assembler Version 2.52 (11010702) 20-Oct-16     22:34:09     page:   8


PC     Object              I  Line    Source uart.src
                           A   365    .endef
                           A   366    .begfunc "isr_U1_TX",65,"_isr_U1_TX"
0000B7 C8FFD0              A   367    	PUSHX	4093
0000BA D6 0000             A   368    	CALL	__b_iframeset00
                           A   369    ;   63	
                           A   370    ;   64	#pragma interrupt
                           A   371    ;   65	void isr_U1_TX(void){
                           A   372    ;   66		txFinished = 1;
                           A   373    .line 66
0000BD E9010001            A   374    	LDX	_txFinished,#1
                           A   375    ;   67	}
                           A   376    .line 67
0000C1 D6 0000             A   377    	CALL	__b_iframereset
0000C4 BF                  A   378    	IRET	
                           A   379    .endfunc "isr_U1_TX",67,"_isr_U1_TX"
000010 00B7                A   380    	VECTOR	UART0_TX=_isr_U1_TX
00000E 00A3                A   381    	VECTOR	UART0_RX=_isr_U1_RX
                           A   382    	XREF _strlen:ROM
                           A   383    	XREF __b_framereset:ROM
                           A   384    	XREF __b_iframereset:ROM
                           A   385    	XREF __b_frameset0:ROM
                           A   386    	XREF __b_frameset00:ROM
                           A   387    	XREF __b_iframeset00:ROM
                           A   388    	XDEF _isr_U1_TX
                           A   389    	XDEF _isr_U1_RX
                           A   390    	XDEF _commandF
                           A   391    	XDEF _sendString
                           A   392    	XDEF _init_coms
                           A   393    	XDEF _rxFlag
                           A   394    	XDEF _command
                           A   395    	XDEF _txFinished
                           A   396    	XDEF _string
                           A   397    	XDEF _inChar
                           A   398    	END


Errors: 0
Warnings: 0
Lines Assembled: 399
